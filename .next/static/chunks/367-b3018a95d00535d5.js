"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[367],{367:function(e,r,a){a.d(r,{a:function(){return i}});var t=a(7437),s=a(2265),o=a(1814),n=a(4977),d=a(6760);function i(e){let{onFoodSelect:r,onFoodDetail:a,initialQuery:n="",maxResults:i=20,allowMultiSelect:c=!1,className:u=""}=e,{isLoading:h,error:f,searchResults:g,searchMeta:y,searchFoodsSimple:p,getFoodDetail:x,clearResults:m,isAvailable:b}=(0,o.X)(),[w,v]=(0,s.useState)(n),[j,N]=(0,s.useState)(new Set),[S,k]=(0,s.useState)(null),[C,E]=(0,s.useState)({dataType:["Foundation","Branded"],sortBy:"lowercaseDescription.keyword",sortOrder:"asc"});(0,s.useEffect)(()=>{(async()=>{k(await b())})()},[b]);let I=(0,s.useCallback)(async()=>{if(w.trim())try{await p(w.trim(),{pageSize:i,pageNumber:0,dataType:C.dataType,sortBy:C.sortBy,sortOrder:C.sortOrder})}catch(e){console.error("Search error:",e)}},[w,i,C,p]),T=(0,s.useCallback)(async e=>{if(r)try{let a=await x(e.fdcId,"abridged");r(a.foodItem),c?N(r=>{let a=new Set(r);return a.has(e.fdcId)?a.delete(e.fdcId):a.add(e.fdcId),a}):N(new Set([e.fdcId]))}catch(e){console.error("Error selecting food:",e)}},[r,x,c]),L=(0,s.useCallback)(e=>{"Enter"===e.key&&I()},[I]),P=(0,s.useCallback)(()=>{v(""),N(new Set),m()},[m]);return!1===S?(0,t.jsxs)("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4 ".concat(u),children:[(0,t.jsxs)("div",{className:"flex items-center mb-2",children:[(0,t.jsx)("div",{className:"w-5 h-5 bg-yellow-400 rounded-full mr-2"}),(0,t.jsx)("h3",{className:"text-sm font-medium text-yellow-800",children:"FDC Search Unavailable"})]}),(0,t.jsx)("p",{className:"text-sm text-yellow-700",children:"The USDA FoodData Central service is currently unavailable. You can still add foods manually."})]}):(0,t.jsxs)("div",{className:"space-y-4 ".concat(u),children:[(0,t.jsxs)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[(0,t.jsxs)("div",{className:"flex items-center mb-2",children:[(0,t.jsx)("div",{className:"w-5 h-5 bg-blue-500 rounded-full mr-2"}),(0,t.jsx)("h3",{className:"text-sm font-medium text-blue-800",children:"Search USDA Food Database"})]}),(0,t.jsx)("p",{className:"text-sm text-blue-700",children:"Search from 300,000+ foods with automatic color categorization and nutritional information."})]}),(0,t.jsxs)("div",{className:"flex flex-col space-y-3",children:[(0,t.jsxs)("div",{className:"flex space-x-2",children:[(0,t.jsx)("input",{type:"text",value:w,onChange:e=>v(e.target.value),onKeyPress:L,placeholder:"Search for foods (e.g., 'chicken breast', 'quinoa', 'blueberries')",className:"flex-1 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",disabled:h}),(0,t.jsx)(d.z,{onClick:I,disabled:h||!w.trim(),className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50",children:h?"Searching...":"Search"}),(g.length>0||w)&&(0,t.jsx)(d.z,{onClick:P,className:"px-4 py-2 bg-gray-500 text-white rounded-md hover:bg-gray-600",children:"Clear"})]}),(0,t.jsxs)("div",{className:"flex flex-wrap gap-3 text-sm",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)("label",{className:"text-gray-600",children:"Data Type:"}),(0,t.jsxs)("select",{value:C.dataType.join(","),onChange:e=>E(r=>({...r,dataType:e.target.value.split(",").filter(Boolean)})),className:"border border-gray-300 rounded px-2 py-1",children:[(0,t.jsx)("option",{value:"Foundation,Branded",children:"Foundation & Branded"}),(0,t.jsx)("option",{value:"Foundation",children:"Foundation Only"}),(0,t.jsx)("option",{value:"Branded",children:"Branded Only"}),(0,t.jsx)("option",{value:"Survey",children:"Survey Foods"})]})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)("label",{className:"text-gray-600",children:"Sort by:"}),(0,t.jsxs)("select",{value:C.sortBy,onChange:e=>E(r=>({...r,sortBy:e.target.value})),className:"border border-gray-300 rounded px-2 py-1",children:[(0,t.jsx)("option",{value:"lowercaseDescription.keyword",children:"Name"}),(0,t.jsx)("option",{value:"dataType.keyword",children:"Type"}),(0,t.jsx)("option",{value:"publishedDate",children:"Date"})]})]})]})]}),f&&(0,t.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3",children:(0,t.jsx)("p",{className:"text-sm text-red-600",children:f})}),y&&(0,t.jsx)("div",{className:"text-sm text-gray-600 bg-gray-50 rounded-lg p-3",children:(0,t.jsxs)("p",{children:["Found ",y.resultsCount,' results for "',y.query,'"',y.resultsCount>=i&&" (showing first ".concat(i,")")]})}),g.length>0&&(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsx)("h4",{className:"font-medium text-gray-900",children:"Search Results"}),(0,t.jsx)("div",{className:"space-y-2 max-h-96 overflow-y-auto",children:g.map(e=>(0,t.jsx)(l,{food:e,isSelected:j.has(e.fdcId),onSelect:()=>T(e),onViewDetail:()=>null==a?void 0:a(e.fdcId)},e.fdcId))})]}),j.size>0&&c&&(0,t.jsx)("div",{className:"bg-green-50 border border-green-200 rounded-lg p-3",children:(0,t.jsxs)("p",{className:"text-sm text-green-800",children:[j.size," food",1!==j.size?"s":""," selected"]})})]})}function l(e){let{food:r,isSelected:a,onSelect:s,onViewDetail:o}=e;return(0,t.jsx)("div",{className:"border rounded-lg p-3 cursor-pointer transition-colors ".concat(a?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300 hover:bg-gray-50"),onClick:s,children:(0,t.jsxs)("div",{className:"flex items-start justify-between",children:[(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-2 mb-1",children:[(0,t.jsx)(n.r,{category:r.category||"yellow",size:"sm",children:r.category||"yellow"}),(0,t.jsx)("h5",{className:"font-medium text-gray-900 truncate",children:r.description})]}),(0,t.jsxs)("div",{className:"flex flex-wrap gap-2 text-xs text-gray-500",children:[(0,t.jsx)("span",{className:"bg-gray-100 px-2 py-1 rounded",children:r.dataType}),(0,t.jsxs)("span",{children:["FDC ID: ",r.fdcId]}),r.brandOwner&&(0,t.jsx)("span",{className:"bg-blue-100 px-2 py-1 rounded",children:r.brandOwner})]}),r.portionGuidelines&&(0,t.jsx)("p",{className:"text-xs text-gray-600 mt-1",children:r.portionGuidelines})]}),o&&(0,t.jsx)(d.z,{onClick:e=>{e.stopPropagation(),o()},className:"ml-2 px-2 py-1 text-xs bg-gray-100 hover:bg-gray-200 rounded",children:"Details"})]})})}},6410:function(e,r,a){a.d(r,{AuthProvider:function(){return h},a:function(){return u}});var t=a(7437),s=a(2265),o=a(5735),n=a(9842),d=a(5419);class i{async signIn(e,r){try{return(await (0,o.e5)(d.I,e,r)).user}catch(e){throw Error(this.getAuthErrorMessage(e.code))}}async createCoach(e,r,a){try{let t=await (0,o.Xb)(d.I,e,r),s={email:e,name:a,createdAt:n.EK.now(),preferences:{colorCodingStyle:"standard"}};await (0,n.pl)((0,n.JU)(d.db,"coaches",t.user.uid),s)}catch(e){throw Error(this.getAuthErrorMessage(e.code))}}async signOut(){try{await (0,o.w7)(d.I)}catch(e){throw Error("Failed to sign out. Please try again.")}}async getCoachProfile(e){try{let r=(0,n.JU)(d.db,"coaches",e),a=await (0,n.QT)(r);if(a.exists())return{id:a.id,...a.data()};return null}catch(e){return console.error("Error fetching coach profile:",e),null}}onAuthStateChange(e){return(0,o.Aj)(d.I,e)}getCurrentUser(){return d.I.currentUser}getAuthErrorMessage(e){switch(e){case"auth/user-not-found":return"No account found with this email address.";case"auth/wrong-password":return"Incorrect password. Please try again.";case"auth/email-already-in-use":return"An account with this email already exists.";case"auth/weak-password":return"Password should be at least 6 characters long.";case"auth/invalid-email":return"Please enter a valid email address.";case"auth/too-many-requests":return"Too many failed attempts. Please try again later.";default:return"An error occurred during authentication. Please try again."}}}let l=new i,c=(0,s.createContext)(void 0);function u(){let e=(0,s.useContext)(c);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}function h(e){let{children:r}=e,[a,o]=(0,s.useState)(null),[n,d]=(0,s.useState)(null),[i,u]=(0,s.useState)(!0);(0,s.useEffect)(()=>l.onAuthStateChange(async e=>{if(o(e),e)try{let r=await l.getCoachProfile(e.uid);d(r)}catch(e){console.error("Error fetching coach profile:",e),d(null)}else d(null);u(!1)}),[]);let h=async(e,r)=>{u(!0);try{await l.signIn(e,r)}catch(e){throw u(!1),e}},f=async(e,r,a)=>{u(!0);try{await l.createCoach(e,r,a),await l.signIn(e,r)}catch(e){throw u(!1),e}},g=async()=>{u(!0);try{await l.signOut()}catch(e){throw u(!1),e}},y=async()=>{if(a)try{let e=await l.getCoachProfile(a.uid);d(e)}catch(e){console.error("Error refreshing coach profile:",e)}};return(0,t.jsx)(c.Provider,{value:{user:a,coach:n,loading:i,signIn:h,signUp:f,signOut:g,refreshCoachProfile:y},children:r})}},6760:function(e,r,a){a.d(r,{z:function(){return o}});var t=a(7437);a(2265);var s=a(4839);function o(e){let{variant:r="primary",size:a="md",children:o,isLoading:n=!1,disabled:d,className:i,...l}=e;return(0,t.jsx)("button",{className:(0,s.W)("font-prompt font-medium transition-all duration-200 focus:ring-2 focus:ring-brand-focus focus:outline-none disabled:opacity-50 disabled:cursor-not-allowed",{primary:"bg-brand-gold text-brand-dark hover:bg-brand-hover disabled:hover:bg-brand-gold",secondary:"bg-brand-dark text-brand-white hover:bg-brand-dark/90",outline:"border-2 border-brand-gold text-brand-gold hover:bg-brand-gold hover:text-brand-dark",ghost:"text-brand-gold hover:bg-brand-gold/10"}[r],{sm:"px-3 py-1.5 text-sm rounded-md min-h-[36px]",md:"px-4 py-2 text-base rounded-lg min-h-[44px] touch-target",lg:"px-6 py-3 text-lg rounded-lg min-h-[52px]"}[a],i),disabled:d||n,...l,children:n?(0,t.jsxs)("div",{className:"flex items-center justify-center space-x-2",children:[(0,t.jsx)("div",{className:"w-4 h-4 border-2 border-current border-t-transparent rounded-full animate-spin"}),(0,t.jsx)("span",{children:"Loading..."})]}):o})}},4977:function(e,r,a){a.d(r,{r:function(){return o}});var t=a(7437);a(2265);var s=a(4839);function o(e){let{category:r,children:a,size:o="md",className:n}=e;return(0,t.jsx)("span",{className:(0,s.W)("inline-flex items-center rounded-full border font-prompt transition-all duration-200",{blue:"bg-food-blue-100 text-food-blue-800 border-food-blue-200",yellow:"bg-food-yellow-100 text-food-yellow-800 border-food-yellow-200",red:"bg-food-red-100 text-food-red-800 border-food-red-200"}[r],{sm:"px-2 py-1 text-xs font-medium",md:"px-3 py-1.5 text-sm font-medium",lg:"px-4 py-2 text-base font-semibold"}[o],n),children:a})}},5419:function(e,r,a){a.d(r,{I:function(){return i},db:function(){return d}});var t=a(5236),s=a(9842),o=a(5735);let n=(0,t.ZF)({apiKey:"AIzaSyBQZagyMTpFNsoSOh4cKT8PVV_xbCuiX8s",authDomain:"ingredients-for-ownershi-81eaf.firebaseapp.com",projectId:"ingredients-for-ownershi-81eaf",storageBucket:"ingredients-for-ownershi-81eaf.firebasestorage.app",messagingSenderId:"855662446831",appId:"1:855662446831:web:deff590004f93f5cec731a"}),d=(0,s.ad)(n),i=(0,o.v0)(n)},666:function(e,r,a){a.d(r,{a:function(){return t.a}});var t=a(6410)},1814:function(e,r,a){a.d(r,{X:function(){return o}});var t=a(2265),s=a(666);function o(){let{user:e}=(0,s.a)(),[r,a]=(0,t.useState)({isLoading:!1,error:null,searchResults:[],searchMeta:null}),o=(0,t.useCallback)(async()=>{if(!e)throw Error("User not authenticated");let r=await e.getIdToken();return{Authorization:"Bearer ".concat(r),"Content-Type":"application/json"}},[e]),n=(0,t.useCallback)(async e=>{a(e=>({...e,isLoading:!0,error:null}));try{let r=await o(),t=await fetch("/api/fdc/search",{method:"POST",headers:r,body:JSON.stringify(e)});if(!t.ok){let e=await t.json();throw Error(e.error||"Failed to search foods")}let s=await t.json();return a(e=>({...e,isLoading:!1,searchResults:s.data,searchMeta:s.meta})),s.data}catch(r){let e=r instanceof Error?r.message:"Unknown error occurred";throw a(r=>({...r,isLoading:!1,error:e})),r}},[o]),d=(0,t.useCallback)(async(e,r)=>{a(e=>({...e,isLoading:!0,error:null}));try{let t=await o(),s=new URLSearchParams({query:e});(null==r?void 0:r.pageSize)&&s.set("pageSize",r.pageSize.toString()),(null==r?void 0:r.pageNumber)&&s.set("pageNumber",r.pageNumber.toString()),(null==r?void 0:r.dataType)&&s.set("dataType",r.dataType.join(",")),(null==r?void 0:r.sortBy)&&s.set("sortBy",r.sortBy),(null==r?void 0:r.sortOrder)&&s.set("sortOrder",r.sortOrder);let n=await fetch("/api/fdc/search?".concat(s),{method:"GET",headers:t});if(!n.ok){let e=await n.json();throw Error(e.error||"Failed to search foods")}let d=await n.json();return a(e=>({...e,isLoading:!1,searchResults:d.data,searchMeta:d.meta})),d.data}catch(r){let e=r instanceof Error?r.message:"Unknown error occurred";throw a(r=>({...r,isLoading:!1,error:e})),r}},[o]),i=(0,t.useCallback)(async function(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"abridged";a(e=>({...e,isLoading:!0,error:null}));try{let t=await o(),s=new URLSearchParams({format:r}),n=await fetch("/api/fdc/foods/".concat(e,"?").concat(s),{method:"GET",headers:t});if(!n.ok){let e=await n.json();throw Error(e.error||"Failed to fetch food details")}let d=await n.json();return a(e=>({...e,isLoading:!1})),d.data}catch(r){let e=r instanceof Error?r.message:"Unknown error occurred";throw a(r=>({...r,isLoading:!1,error:e})),r}},[o]),l=(0,t.useCallback)(async function(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"abridged",t=arguments.length>2?arguments[2]:void 0;a(e=>({...e,isLoading:!0,error:null}));try{let s=await o(),n=await fetch("/api/fdc/foods",{method:"POST",headers:s,body:JSON.stringify({fdcIds:e,format:r,nutrients:t})});if(!n.ok){let e=await n.json();throw Error(e.error||"Failed to fetch foods details")}let d=await n.json();return a(e=>({...e,isLoading:!1})),d.data}catch(r){let e=r instanceof Error?r.message:"Unknown error occurred";throw a(r=>({...r,isLoading:!1,error:e})),r}},[o]),c=(0,t.useCallback)(()=>{a({isLoading:!1,error:null,searchResults:[],searchMeta:null})},[]),u=(0,t.useCallback)(async()=>{try{let e=await o(),r=await fetch("/api/fdc/search?query=apple&pageSize=1",{method:"GET",headers:e});return 503!==r.status}catch(e){return!1}},[o]);return{isLoading:r.isLoading,error:r.error,searchResults:r.searchResults,searchMeta:r.searchMeta,searchFoods:n,searchFoodsSimple:d,getFoodDetail:i,getFoodsDetails:l,clearResults:c,isAvailable:u}}},4839:function(e,r,a){a.d(r,{W:function(){return t}});function t(){for(var e,r,a=0,t="",s=arguments.length;a<s;a++)(e=arguments[a])&&(r=function e(r){var a,t,s="";if("string"==typeof r||"number"==typeof r)s+=r;else if("object"==typeof r){if(Array.isArray(r)){var o=r.length;for(a=0;a<o;a++)r[a]&&(t=e(r[a]))&&(s&&(s+=" "),s+=t)}else for(t in r)r[t]&&(s&&(s+=" "),s+=t)}return s}(e))&&(t&&(t+=" "),t+=r);return t}}}]);
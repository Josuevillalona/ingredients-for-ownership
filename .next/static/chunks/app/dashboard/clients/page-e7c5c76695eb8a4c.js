(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[198],{6930:function(e,t,r){Promise.resolve().then(r.bind(r,5884))},5884:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return m}});var a=r(7437),s=r(2265),n=r(7138),i=r(6760),o=r(6976),l=r(666);function d(e){let{onSubmit:t,onCancel:r,isLoading:n=!1}=e,[o,l]=(0,s.useState)({name:"",email:"",sessionNotes:"",goals:[""],restrictions:[""]}),[d,c]=(0,s.useState)({}),m=e=>{let{name:t,value:r}=e.target;l(e=>({...e,[t]:r})),d[t]&&c(e=>({...e,[t]:""}))},u=(e,t,r)=>{l(a=>({...a,[e]:a[e].map((e,a)=>a===t?r:e)}))},h=e=>{l(t=>({...t,[e]:[...t[e],""]}))},x=(e,t)=>{l(r=>({...r,[e]:r[e].filter((e,r)=>r!==t)}))},b=()=>{let e={};return o.name.trim()||(e.name="Client name is required"),o.email&&!o.email.includes("@")&&(e.email="Please enter a valid email address"),0===o.goals.filter(e=>e.trim().length>0).length&&(e.goals="At least one goal is required"),c(e),0===Object.keys(e).length},g=async e=>{if(e.preventDefault(),b())try{await t(o)}catch(e){}};return(0,a.jsx)("div",{className:"bg-brand-white rounded-xl p-6 shadow-sm border border-brand-gold/20",children:(0,a.jsxs)("form",{onSubmit:g,className:"space-y-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"name",className:"block text-sm font-medium text-brand-dark mb-2 font-prompt",children:"Client Name *"}),(0,a.jsx)("input",{type:"text",id:"name",name:"name",value:o.name,onChange:m,className:"w-full px-3 py-3 border rounded-lg focus:ring-2 focus:ring-brand-focus focus:border-transparent font-prompt ".concat(d.name?"border-red-300":"border-gray-300"),placeholder:"Enter client's full name"}),d.name&&(0,a.jsx)("p",{className:"mt-1 text-sm text-red-600",children:d.name})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"email",className:"block text-sm font-medium text-brand-dark mb-2 font-prompt",children:"Email Address (Optional)"}),(0,a.jsx)("input",{type:"email",id:"email",name:"email",value:o.email,onChange:m,className:"w-full px-3 py-3 border rounded-lg focus:ring-2 focus:ring-brand-focus focus:border-transparent font-prompt ".concat(d.email?"border-red-300":"border-gray-300"),placeholder:"client@example.com"}),d.email&&(0,a.jsx)("p",{className:"mt-1 text-sm text-red-600",children:d.email})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"sessionNotes",className:"block text-sm font-medium text-brand-dark mb-2 font-prompt",children:"Session Notes"}),(0,a.jsx)("textarea",{id:"sessionNotes",name:"sessionNotes",value:o.sessionNotes,onChange:m,rows:3,className:"w-full px-3 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-brand-focus focus:border-transparent font-prompt resize-none",placeholder:"Initial session notes, health concerns, background info..."})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-brand-dark mb-2 font-prompt",children:"Health & Nutrition Goals *"}),o.goals.map((e,t)=>(0,a.jsxs)("div",{className:"flex gap-2 mb-2",children:[(0,a.jsx)("input",{type:"text",value:e,onChange:e=>u("goals",t,e.target.value),className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-brand-focus focus:border-transparent font-prompt",placeholder:"Goal ".concat(t+1,' (e.g., "Lose 15 pounds", "Increase energy")')}),o.goals.length>1&&(0,a.jsx)(i.z,{type:"button",variant:"outline",size:"sm",onClick:()=>x("goals",t),className:"px-3",children:"Remove"})]},t)),(0,a.jsx)(i.z,{type:"button",variant:"outline",size:"sm",onClick:()=>h("goals"),className:"mt-2",children:"+ Add Another Goal"}),d.goals&&(0,a.jsx)("p",{className:"mt-1 text-sm text-red-600",children:d.goals})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-brand-dark mb-2 font-prompt",children:"Dietary Restrictions & Allergies"}),o.restrictions.map((e,t)=>(0,a.jsxs)("div",{className:"flex gap-2 mb-2",children:[(0,a.jsx)("input",{type:"text",value:e,onChange:e=>u("restrictions",t,e.target.value),className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-brand-focus focus:border-transparent font-prompt",placeholder:"Restriction ".concat(t+1,' (e.g., "Gluten-free", "Nut allergy")')}),o.restrictions.length>1&&(0,a.jsx)(i.z,{type:"button",variant:"outline",size:"sm",onClick:()=>x("restrictions",t),className:"px-3",children:"Remove"})]},t)),(0,a.jsx)(i.z,{type:"button",variant:"outline",size:"sm",onClick:()=>h("restrictions"),className:"mt-2",children:"+ Add Another Restriction"})]}),(0,a.jsxs)("div",{className:"flex gap-3 pt-4",children:[(0,a.jsx)(i.z,{type:"submit",variant:"primary",size:"lg",isLoading:n,className:"flex-1",children:n?"Creating Client...":"Create Client"}),(0,a.jsx)(i.z,{type:"button",variant:"outline",size:"lg",onClick:r,disabled:n,children:"Cancel"})]})]})})}function c(e){var t;let{client:r,onEdit:s,onDelete:o}=e;return(0,a.jsxs)("div",{className:"bg-brand-white rounded-xl p-6 shadow-sm border border-brand-gold/20 hover:shadow-md transition-shadow",children:[(0,a.jsxs)("div",{className:"flex justify-between items-start mb-4",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("h3",{className:"font-prompt font-semibold text-xl text-brand-dark mb-1",children:r.name}),r.email&&(0,a.jsx)("p",{className:"text-brand-dark/60 text-sm font-prompt",children:r.email})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[s&&(0,a.jsx)(i.z,{variant:"outline",size:"sm",onClick:()=>s(r),className:"text-brand-gold border-brand-gold/30 hover:bg-brand-gold/10",children:"Edit"}),o&&(0,a.jsx)(i.z,{variant:"outline",size:"sm",onClick:()=>o(r),className:"text-red-600 border-red-200 hover:bg-red-50",children:"Delete"})]})]}),r.goals.length>0&&(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("h4",{className:"text-sm font-medium text-brand-dark mb-2 font-prompt",children:"Goals:"}),(0,a.jsxs)("div",{className:"space-y-1",children:[r.goals.slice(0,2).map((e,t)=>(0,a.jsxs)("div",{className:"text-sm text-brand-dark/70 flex items-center",children:[(0,a.jsx)("span",{className:"w-1.5 h-1.5 bg-brand-gold rounded-full mr-2 flex-shrink-0"}),e]},t)),r.goals.length>2&&(0,a.jsxs)("p",{className:"text-xs text-brand-dark/50 font-prompt",children:["+",r.goals.length-2," more goals"]})]})]}),r.restrictions.length>0&&(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("h4",{className:"text-sm font-medium text-brand-dark mb-2 font-prompt",children:"Restrictions:"}),(0,a.jsxs)("div",{className:"flex flex-wrap gap-1",children:[r.restrictions.slice(0,3).map((e,t)=>(0,a.jsx)("span",{className:"px-2 py-1 bg-red-50 text-red-600 rounded-md text-xs font-prompt",children:e},t)),r.restrictions.length>3&&(0,a.jsxs)("span",{className:"px-2 py-1 bg-gray-100 text-gray-600 rounded-md text-xs font-prompt",children:["+",r.restrictions.length-3]})]})]}),r.sessionNotes&&(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("h4",{className:"text-sm font-medium text-brand-dark mb-1 font-prompt",children:"Notes:"}),(0,a.jsx)("p",{className:"text-sm text-brand-dark/70 line-clamp-2",children:r.sessionNotes.length>100?"".concat(r.sessionNotes.substring(0,100),"..."):r.sessionNotes})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center pt-4 border-t border-gray-100",children:[(0,a.jsxs)("div",{className:"text-xs text-brand-dark/50 font-prompt",children:["Created: ",(t=r.createdAt)?(t.toDate?t.toDate():new Date(t)).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}):"Unknown"]}),(0,a.jsx)(n.default,{href:"/dashboard/clients/".concat(r.id),children:(0,a.jsx)(i.z,{variant:"primary",size:"sm",children:"View Details"})})]})]})}function m(){let{clients:e,isLoading:t,error:r,createClient:m,deleteClient:u}=(0,o.a)(),{user:h,loading:x}=(0,l.a)(),[b,g]=(0,s.useState)(!1),[f,p]=(0,s.useState)(!1),[w,y]=(0,s.useState)(""),v=async e=>{p(!0);try{await m(e),g(!1)}catch(e){}finally{p(!1)}},N=async e=>{if(window.confirm("Are you sure you want to delete ".concat(e.name,"? This action cannot be undone.")))try{await u(e.id)}catch(e){}},j=e.filter(e=>{var t;return e.name.toLowerCase().includes(w.toLowerCase())||(null===(t=e.email)||void 0===t?void 0:t.toLowerCase().includes(w.toLowerCase()))||e.goals.some(e=>e.toLowerCase().includes(w.toLowerCase()))});return(0,a.jsxs)("div",{className:"min-h-screen bg-brand-cream",children:[(0,a.jsx)("header",{className:"bg-brand-dark shadow-lg border-b border-brand-gold/20",children:(0,a.jsx)("div",{className:"max-w-7xl mx-auto px-4 py-6",children:(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)(n.default,{href:"/dashboard",className:"text-brand-white/60 hover:text-brand-white",children:"â† Back"}),(0,a.jsx)("h1",{className:"text-brand-white font-prompt font-bold text-2xl",children:"My Clients"})]}),(0,a.jsx)(i.z,{variant:"primary",onClick:()=>g(!0),disabled:b,children:"Add New Client"})]})})}),(0,a.jsxs)("main",{className:"max-w-7xl mx-auto px-4 py-8",children:[!1,r&&(0,a.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-6",children:(0,a.jsx)("p",{className:"text-red-600 text-sm font-prompt",children:r})}),b&&(0,a.jsxs)("div",{className:"mb-8",children:[(0,a.jsx)("h2",{className:"font-prompt font-bold text-xl text-brand-dark mb-4",children:"Add New Client"}),(0,a.jsx)(d,{onSubmit:v,onCancel:()=>g(!1),isLoading:f})]}),t&&!b&&(0,a.jsxs)("div",{className:"bg-brand-white rounded-xl p-12 shadow-sm border border-brand-gold/20 text-center",children:[(0,a.jsx)("div",{className:"animate-spin w-8 h-8 border-2 border-brand-gold border-t-transparent rounded-full mx-auto mb-4"}),(0,a.jsx)("p",{className:"text-brand-dark/60 font-prompt",children:"Loading your clients..."})]}),!t&&!b&&(0,a.jsx)(a.Fragment,{children:0===e.length?(0,a.jsxs)("div",{className:"bg-brand-white rounded-xl p-12 shadow-sm border border-brand-gold/20 text-center",children:[(0,a.jsx)("div",{className:"w-24 h-24 bg-brand-cream rounded-full mx-auto mb-6 flex items-center justify-center",children:(0,a.jsx)("span",{className:"text-brand-gold text-4xl",children:"\uD83D\uDC65"})}),(0,a.jsx)("h2",{className:"font-prompt font-bold text-2xl text-brand-dark mb-4",children:"No Clients Yet"}),(0,a.jsx)("p",{className:"text-brand-dark/60 mb-8 max-w-md mx-auto",children:"Start building your coaching practice by adding your first client. You'll be able to create personalized nutrition plans for each client."}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)(i.z,{variant:"primary",size:"lg",onClick:()=>{console.log("Add client button clicked"),g(!0)},children:"Add Your First Client"}),(0,a.jsxs)("div",{className:"text-sm text-brand-dark/60",children:["or ",(0,a.jsx)(n.default,{href:"/dashboard",className:"text-brand-gold hover:underline",children:"return to dashboard"})]})]})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"mb-6",children:(0,a.jsx)("div",{className:"max-w-md",children:(0,a.jsx)("input",{type:"text",placeholder:"Search clients by name, email, or goals...",value:w,onChange:e=>y(e.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-brand-focus focus:border-transparent font-prompt"})})}),(0,a.jsx)("div",{className:"mb-6",children:(0,a.jsxs)("p",{className:"text-brand-dark/60 font-prompt",children:[j.length," of ",e.length," clients",w&&' matching "'.concat(w,'"')]})}),j.length>0?(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:j.map(e=>(0,a.jsx)(c,{client:e,onDelete:N},e.id))}):(0,a.jsxs)("div",{className:"bg-brand-white rounded-xl p-8 shadow-sm border border-brand-gold/20 text-center",children:[(0,a.jsxs)("p",{className:"text-brand-dark/60 font-prompt",children:['No clients found matching "',w,'"']}),(0,a.jsx)(i.z,{variant:"outline",className:"mt-4",onClick:()=>y(""),children:"Clear Search"})]})]})})]})]})}},6410:function(e,t,r){"use strict";r.d(t,{AuthProvider:function(){return u},a:function(){return m}});var a=r(7437),s=r(2265),n=r(5735),i=r(9842),o=r(5419);class l{async signIn(e,t){try{return(await (0,n.e5)(o.I,e,t)).user}catch(e){throw Error(this.getAuthErrorMessage(e.code))}}async createCoach(e,t,r){try{let a=await (0,n.Xb)(o.I,e,t),s={email:e,name:r,createdAt:i.EK.now(),preferences:{colorCodingStyle:"standard"}};await (0,i.pl)((0,i.JU)(o.db,"coaches",a.user.uid),s)}catch(e){throw Error(this.getAuthErrorMessage(e.code))}}async signOut(){try{await (0,n.w7)(o.I)}catch(e){throw Error("Failed to sign out. Please try again.")}}async getCoachProfile(e){try{let t=(0,i.JU)(o.db,"coaches",e),r=await (0,i.QT)(t);if(r.exists())return{id:r.id,...r.data()};return null}catch(e){return console.error("Error fetching coach profile:",e),null}}onAuthStateChange(e){return(0,n.Aj)(o.I,e)}getCurrentUser(){return o.I.currentUser}getAuthErrorMessage(e){switch(e){case"auth/user-not-found":return"No account found with this email address.";case"auth/wrong-password":return"Incorrect password. Please try again.";case"auth/email-already-in-use":return"An account with this email already exists.";case"auth/weak-password":return"Password should be at least 6 characters long.";case"auth/invalid-email":return"Please enter a valid email address.";case"auth/too-many-requests":return"Too many failed attempts. Please try again later.";default:return"An error occurred during authentication. Please try again."}}}let d=new l,c=(0,s.createContext)(void 0);function m(){let e=(0,s.useContext)(c);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}function u(e){let{children:t}=e,[r,n]=(0,s.useState)(null),[i,o]=(0,s.useState)(null),[l,m]=(0,s.useState)(!0);(0,s.useEffect)(()=>d.onAuthStateChange(async e=>{if(n(e),e)try{let t=await d.getCoachProfile(e.uid);o(t)}catch(e){console.error("Error fetching coach profile:",e),o(null)}else o(null);m(!1)}),[]);let u=async(e,t)=>{m(!0);try{await d.signIn(e,t)}catch(e){throw m(!1),e}},h=async(e,t,r)=>{m(!0);try{await d.createCoach(e,t,r),await d.signIn(e,t)}catch(e){throw m(!1),e}},x=async()=>{m(!0);try{await d.signOut()}catch(e){throw m(!1),e}},b=async()=>{if(r)try{let e=await d.getCoachProfile(r.uid);o(e)}catch(e){console.error("Error refreshing coach profile:",e)}};return(0,a.jsx)(c.Provider,{value:{user:r,coach:i,loading:l,signIn:u,signUp:h,signOut:x,refreshCoachProfile:b},children:t})}},6760:function(e,t,r){"use strict";r.d(t,{z:function(){return n}});var a=r(7437);r(2265);var s=r(4839);function n(e){let{variant:t="primary",size:r="md",children:n,isLoading:i=!1,disabled:o,className:l,...d}=e;return(0,a.jsx)("button",{className:(0,s.W)("font-prompt font-medium transition-all duration-200 focus:ring-2 focus:ring-brand-focus focus:outline-none disabled:opacity-50 disabled:cursor-not-allowed",{primary:"bg-brand-gold text-brand-dark hover:bg-brand-hover disabled:hover:bg-brand-gold",secondary:"bg-brand-dark text-brand-white hover:bg-brand-dark/90",outline:"border-2 border-brand-gold text-brand-gold hover:bg-brand-gold hover:text-brand-dark",ghost:"text-brand-gold hover:bg-brand-gold/10"}[t],{sm:"px-3 py-1.5 text-sm rounded-md min-h-[36px]",md:"px-4 py-2 text-base rounded-lg min-h-[44px] touch-target",lg:"px-6 py-3 text-lg rounded-lg min-h-[52px]"}[r],l),disabled:o||i,...d,children:i?(0,a.jsxs)("div",{className:"flex items-center justify-center space-x-2",children:[(0,a.jsx)("div",{className:"w-4 h-4 border-2 border-current border-t-transparent rounded-full animate-spin"}),(0,a.jsx)("span",{children:"Loading..."})]}):n})}},3196:function(e,t,r){"use strict";r.d(t,{T:function(){return i}});var a=r(9842),s=r(5419);class n{async createClient(e,t){try{var r,n;let i=(0,a.JU)((0,a.hJ)(s.db,this.collectionName)),o=i.id,l={coachId:e,name:t.name.trim(),sessionNotes:(null===(r=t.sessionNotes)||void 0===r?void 0:r.trim())||"",goals:t.goals.filter(e=>e.trim().length>0),restrictions:t.restrictions.filter(e=>e.trim().length>0),createdAt:a.EK.now(),lastUpdated:a.EK.now()};return(null===(n=t.email)||void 0===n?void 0:n.trim())&&(l.email=t.email.trim()),await (0,a.pl)(i,l),o}catch(e){throw Error("Failed to create client: ".concat(e.message))}}async getClientsForCoach(e){try{let t=(0,a.IO)((0,a.hJ)(s.db,this.collectionName),(0,a.ar)("coachId","==",e),(0,a.Xo)("lastUpdated","desc"));return(await (0,a.PL)(t)).docs.map(e=>({id:e.id,...e.data()}))}catch(e){throw Error("Failed to fetch clients: ".concat(e.message))}}async getClient(e,t){try{let r=await (0,a.QT)((0,a.JU)(s.db,this.collectionName,e));if(!r.exists())return null;let n=r.data();if(n.coachId!==t)throw Error("Access denied: Client belongs to different coach");return{id:r.id,...n}}catch(e){throw Error("Failed to fetch client: ".concat(e.message))}}async updateClient(e,t,r){try{var n,i,o;if(!await this.getClient(e,t))throw Error("Client not found or access denied");let l={lastUpdated:a.EK.now()};(null===(n=r.name)||void 0===n?void 0:n.trim())&&(l.name=r.name.trim()),void 0!==r.email&&(l.email=(null===(i=r.email)||void 0===i?void 0:i.trim())||void 0),void 0!==r.sessionNotes&&(l.sessionNotes=(null===(o=r.sessionNotes)||void 0===o?void 0:o.trim())||""),r.goals&&(l.goals=r.goals.filter(e=>e.trim().length>0)),r.restrictions&&(l.restrictions=r.restrictions.filter(e=>e.trim().length>0)),await (0,a.r7)((0,a.JU)(s.db,this.collectionName,e),l)}catch(e){throw Error("Failed to update client: ".concat(e.message))}}async deleteClient(e,t){try{if(!await this.getClient(e,t))throw Error("Client not found or access denied");await (0,a.oe)((0,a.JU)(s.db,this.collectionName,e))}catch(e){throw Error("Failed to delete client: ".concat(e.message))}}async searchClients(e,t){try{let r=await this.getClientsForCoach(e);if(!t.trim())return r;let a=t.toLowerCase();return r.filter(e=>{var t;return e.name.toLowerCase().includes(a)||(null===(t=e.email)||void 0===t?void 0:t.toLowerCase().includes(a))||e.goals.some(e=>e.toLowerCase().includes(a))})}catch(e){throw Error("Failed to search clients: ".concat(e.message))}}constructor(){this.collectionName="clients"}}let i=new n},5419:function(e,t,r){"use strict";r.d(t,{I:function(){return l},db:function(){return o}});var a=r(5236),s=r(9842),n=r(5735);let i=(0,a.ZF)({apiKey:"AIzaSyBQZagyMTpFNsoSOh4cKT8PVV_xbCuiX8s",authDomain:"ingredients-for-ownershi-81eaf.firebaseapp.com",projectId:"ingredients-for-ownershi-81eaf",storageBucket:"ingredients-for-ownershi-81eaf.firebasestorage.app",messagingSenderId:"855662446831",appId:"1:855662446831:web:deff590004f93f5cec731a"}),o=(0,s.ad)(i),l=(0,n.v0)(i)},666:function(e,t,r){"use strict";r.d(t,{a:function(){return a.a}});var a=r(6410)},6976:function(e,t,r){"use strict";r.d(t,{a:function(){return i}});var a=r(2265),s=r(666),n=r(3196);function i(){let{user:e}=(0,s.a)(),[t,r]=(0,a.useState)([]),[i,o]=(0,a.useState)(!1),[l,d]=(0,a.useState)(null),c=async()=>{if(e){o(!0),d(null);try{let t=await n.T.getClientsForCoach(e.uid);r(t)}catch(e){d(e.message)}finally{o(!1)}}},m=async t=>{if(!e)throw Error("User not authenticated");try{let r=await n.T.createClient(e.uid,t);return await c(),r}catch(e){throw d(e.message),e}},u=async(t,r)=>{if(!e)throw Error("User not authenticated");try{await n.T.updateClient(t,e.uid,r),await c()}catch(e){throw d(e.message),e}},h=async t=>{if(!e)throw Error("User not authenticated");try{await n.T.deleteClient(t,e.uid),await c()}catch(e){throw d(e.message),e}},x=async t=>{if(!e)return[];try{return await n.T.searchClients(e.uid,t)}catch(e){return d(e.message),[]}};return(0,a.useEffect)(()=>{c()},[e]),{clients:t,isLoading:i,error:l,createClient:m,updateClient:u,deleteClient:h,searchClients:x,refetch:c}}}},function(e){e.O(0,[358,139,990,836,38,971,23,744],function(){return e(e.s=6930)}),_N_E=e.O()}]);
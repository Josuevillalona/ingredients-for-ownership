(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[904],{6903:function(e,t,n){Promise.resolve().then(n.bind(n,2058))},2058:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return u}});var r=n(7437),a=n(2265),s=n(6463),d=n(7516),o=n(6410),l=n(6760),c=n(7138),i=n(7206),m=n(5419),x=n(9842),h=n(2668);function b(e){var t,n;let{document:a,foods:s=[],className:d=""}=e,o=(0,h.zB)(a.ingredients),l=e=>{let t=s.find(t=>t.id===e);return(null==t?void 0:t.name)||e},c={checked:o.completedCount,total:o.trackableCount,percentage:o.percentage};return(0,r.jsxs)("div",{className:"bg-brand-white rounded-lg p-4 border border-brand-gold/20 ".concat(d),children:[(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,r.jsx)("h3",{className:"font-prompt font-semibold text-brand-dark",children:"Nutrition Goals Progress"}),(0,r.jsxs)("span",{className:"text-lg font-bold ".concat((t=c.percentage)>=80?"text-green-600":t>=50?"text-yellow-600":"text-red-600"),children:[c.percentage,"%"]})]}),(0,r.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2 mb-2",children:(0,r.jsx)("div",{className:"h-2 rounded-full transition-all duration-300 ".concat((n=c.percentage)>=80?"bg-green-500":n>=50?"bg-yellow-500":"bg-red-500"),style:{width:"".concat(c.percentage,"%")}})}),(0,r.jsx)("p",{className:"text-sm text-brand-dark/60",children:(0,h.tN)(o)}),o.breakdown.red.total>0&&(0,r.jsxs)("p",{className:"text-xs text-brand-dark/50 mt-1",children:[o.breakdown.red.total," awareness-only item(s) • ",o.breakdown.red.info]})]}),c.checked>0&&(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"font-prompt font-medium text-brand-dark mb-2 text-sm",children:"Recently Checked:"}),(0,r.jsxs)("div",{className:"space-y-1",children:[a.ingredients.filter(e=>e.clientChecked&&("blue"===e.colorCode||"yellow"===e.colorCode)).slice(-3).map(e=>(0,r.jsxs)("div",{className:"flex items-center text-xs",children:[(0,r.jsx)("span",{className:"text-green-600 mr-2",children:"✓"}),(0,r.jsx)("span",{className:"text-brand-dark/70",children:l(e.foodId)})]},e.foodId)),c.checked>3&&(0,r.jsxs)("p",{className:"text-xs text-brand-dark/50 ml-4",children:["+",c.checked-3," more nutrition goals"]})]})]}),0===c.checked&&(0,r.jsx)("div",{className:"text-center py-2",children:(0,r.jsx)("p",{className:"text-sm text-brand-dark/60",children:"Client hasn't started tracking nutrition goals yet"})})]})}function u(){return(0,r.jsx)(d.i,{children:(0,r.jsx)(p,{})})}function p(){let{user:e}=(0,o.a)(),t=(0,s.useRouter)(),n=(0,s.useParams)().id,[d,h]=(0,a.useState)(null),[u,p]=(0,a.useState)([]),[f,g]=(0,a.useState)(!0),[j,N]=(0,a.useState)(null),w=new i.H;(0,a.useEffect)(()=>{e&&n&&y()},[e,n]);let y=async()=>{if(e)try{g(!0),N(null);let t=await w.getDocument(n,e.uid);if(!t){N("Document not found or you do not have permission to view it.");return}h(t);let r=(0,x.IO)((0,x.hJ)(m.db,"foods")),a=(await (0,x.PL)(r)).docs.map(e=>({id:e.id,...e.data()}));p(a)}catch(e){console.error("Error loading document:",e),N("Failed to load document. Please try again.")}finally{g(!1)}},v=()=>{if(d){let e="".concat(window.location.origin,"/share/").concat(d.shareToken);navigator.clipboard.writeText(e),alert("Share link copied to clipboard!")}},k=()=>d?d.ingredients.map(e=>{let t=u.find(t=>t.id===e.foodId);return{...e,food:t}}):[],C=k().reduce((e,t)=>{let n=t.colorCode||"blue";return e[n]||(e[n]=[]),e[n].push(t),e},{});return f?(0,r.jsx)("div",{className:"min-h-screen bg-brand-cream flex items-center justify-center",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"w-16 h-16 bg-brand-gold rounded-full mx-auto mb-4 flex items-center justify-center animate-pulse",children:(0,r.jsx)("span",{className:"text-brand-white font-prompt font-bold text-2xl",children:"I"})}),(0,r.jsx)("p",{className:"text-brand-dark/60 font-prompt",children:"Loading document..."})]})}):j||!d?(0,r.jsx)("div",{className:"min-h-screen bg-brand-cream flex items-center justify-center",children:(0,r.jsxs)("div",{className:"text-center max-w-md",children:[(0,r.jsx)("div",{className:"w-16 h-16 bg-red-500 rounded-full mx-auto mb-4 flex items-center justify-center",children:(0,r.jsx)("span",{className:"text-white font-prompt font-bold text-2xl",children:"!"})}),(0,r.jsx)("h2",{className:"font-prompt font-bold text-xl text-brand-dark mb-2",children:"Document Not Found"}),(0,r.jsx)("p",{className:"text-brand-dark/60 font-prompt mb-4",children:j}),(0,r.jsx)(c.default,{href:"/dashboard",children:(0,r.jsx)(l.z,{variant:"primary",children:"Back to Dashboard"})})]})}):(0,r.jsxs)("div",{className:"min-h-screen bg-brand-cream",children:[(0,r.jsx)("header",{className:"bg-brand-dark shadow-lg border-b border-brand-gold/20",children:(0,r.jsx)("div",{className:"max-w-7xl mx-auto px-4 py-6",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)("div",{className:"flex items-center space-x-3",children:(0,r.jsx)(c.default,{href:"/dashboard",className:"text-brand-white/70 hover:text-brand-white",children:"← Back to Dashboard"})}),(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,r.jsx)("div",{className:"w-8 h-8 bg-brand-gold rounded-lg flex items-center justify-center",children:(0,r.jsx)("span",{className:"text-brand-white font-prompt font-bold text-lg",children:"I"})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"text-brand-white font-prompt font-bold text-2xl",children:"Ingredient Document"}),(0,r.jsxs)("p",{className:"text-brand-white/70 text-sm font-prompt",children:["For ",d.clientName]})]})]})]})})}),(0,r.jsxs)("div",{className:"max-w-4xl mx-auto px-4 py-8",children:[(0,r.jsx)("div",{className:"bg-brand-white rounded-xl shadow-sm border border-brand-gold/20 p-6 mb-8",children:(0,r.jsxs)("div",{className:"flex justify-between items-start mb-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("h2",{className:"font-prompt font-bold text-2xl text-brand-dark mb-2",children:[d.clientName,"'s Nutrition Plan"]}),(0,r.jsxs)("div",{className:"flex items-center space-x-4 text-sm text-brand-dark/60 font-prompt",children:[(0,r.jsxs)("span",{children:["Created: ",d.createdAt.toDate().toLocaleDateString()]}),(0,r.jsxs)("span",{children:["Status: ",d.status]}),(0,r.jsxs)("span",{children:["Foods: ",k().length]})]})]}),(0,r.jsxs)("div",{className:"flex space-x-2",children:[(0,r.jsx)(l.z,{variant:"secondary",size:"sm",onClick:v,children:"Copy Share Link"}),(0,r.jsx)(l.z,{variant:"primary",size:"sm",onClick:()=>t.push("/dashboard/plans/".concat(n,"/edit")),children:"Edit Plan"})]})]})}),(0,r.jsx)("div",{className:"space-y-6",children:["green","yellow","red"].map(e=>{let t=C[e]||[];if(0===t.length)return null;let n={green:{name:"Recommended Foods (Green)",bg:"bg-green-50",border:"border-green-200",text:"text-green-800",badge:"bg-green-500"},yellow:{name:"Moderate Foods (Yellow)",bg:"bg-yellow-50",border:"border-yellow-200",text:"text-yellow-800",badge:"bg-yellow-500"},red:{name:"Foods to Avoid (Red)",bg:"bg-red-50",border:"border-red-200",text:"text-red-800",badge:"bg-red-500"}}[e];return(0,r.jsxs)("div",{className:"".concat(n.bg," ").concat(n.border," border rounded-xl p-6"),children:[(0,r.jsxs)("div",{className:"flex items-center space-x-3 mb-4",children:[(0,r.jsx)("div",{className:"w-4 h-4 ".concat(n.badge," rounded-full")}),(0,r.jsxs)("h3",{className:"font-prompt font-bold text-xl ".concat(n.text),children:[n.name," (",t.length,")"]})]}),(0,r.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:t.map((e,t)=>{var n,a;return(0,r.jsxs)("div",{className:"bg-white rounded-lg p-4 border border-gray-200",children:[(0,r.jsx)("h4",{className:"font-prompt font-semibold text-brand-dark mb-1",children:(null===(n=e.food)||void 0===n?void 0:n.name)||"Unknown Food"}),(null===(a=e.food)||void 0===a?void 0:a.nutritionalHighlights)&&e.food.nutritionalHighlights.length>0&&(0,r.jsx)("p",{className:"text-sm text-brand-dark/60 font-prompt mb-2",children:e.food.nutritionalHighlights.join(", ")}),e.notes&&(0,r.jsxs)("p",{className:"text-sm text-brand-dark/80 font-prompt italic",children:["Note: ",e.notes]})]},"".concat(e.foodId,"-").concat(t))})})]},e)})}),0===k().length&&(0,r.jsx)("div",{className:"bg-brand-white rounded-xl shadow-sm border border-brand-gold/20 p-8 text-center",children:(0,r.jsx)("p",{className:"text-brand-dark/60 font-prompt",children:"No foods have been selected for this plan yet."})}),(0,r.jsx)(b,{document:d,foods:u,className:"mb-8"}),(0,r.jsxs)("div",{className:"bg-brand-white rounded-xl shadow-sm border border-brand-gold/20 p-6",children:[(0,r.jsx)("h3",{className:"font-prompt font-bold text-xl text-brand-dark mb-4",children:"Share with Client"}),(0,r.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4 mb-4",children:[(0,r.jsx)("p",{className:"font-prompt text-sm text-brand-dark/60 mb-2",children:"Share Link:"}),(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)("code",{className:"flex-1 px-3 py-2 bg-white rounded border text-sm font-mono",children:"".concat(window.location.origin,"/share/").concat(d.shareToken)}),(0,r.jsx)(l.z,{variant:"secondary",size:"sm",onClick:v,children:"Copy"})]})]}),(0,r.jsx)("p",{className:"text-sm text-brand-dark/60 font-prompt",children:"Share this link with your client so they can view their personalized nutrition plan. No login required for clients."})]})]})]})}},2668:function(e,t,n){"use strict";function r(e){return"blue"===e||"yellow"===e}function a(e){let t={blue:{total:0,completed:0},yellow:{total:0,completed:0},red:{total:0,info:"For awareness only - enjoy occasionally"}};e.forEach(e=>{let{colorCode:n,clientChecked:r}=e;if(!n){console.warn("Ingredient missing color code:",e.foodId);return}switch(n){case"blue":t.blue.total++,r&&t.blue.completed++;break;case"yellow":t.yellow.total++,r&&t.yellow.completed++;break;case"red":t.red.total++;break;default:console.warn("Unknown color code: ".concat(n))}});let n=t.blue.total+t.yellow.total,r=t.blue.completed+t.yellow.completed;return{trackableCount:n,completedCount:r,percentage:n>0?Math.round(r/n*100):0,breakdown:t}}function s(e){let{completedCount:t,trackableCount:n,percentage:r}=e;return 0===n?"No nutrition goals set yet":0===t?"0 of ".concat(n," nutrition goals started"):100===r?"All ".concat(n," nutrition goals completed! \uD83C\uDF89"):"".concat(t," of ").concat(n," nutrition goals completed (").concat(r,"%)")}function d(e){switch(e){case"blue":return"Great choice! Add this to your regular rotation.";case"yellow":return"Perfect for balanced nutrition in proper portions.";case"red":return"Enjoy occasionally and in moderation. No tracking needed.";default:return"Follow your coach's guidance for this ingredient."}}n.d(t,{XV:function(){return d},tN:function(){return s},v8:function(){return r},zB:function(){return a}})}},function(e){e.O(0,[358,139,990,836,38,732,971,23,744],function(){return e(e.s=6903)}),_N_E=e.O()}]);
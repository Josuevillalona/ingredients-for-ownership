(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[288],{2542:function(e,t,r){Promise.resolve().then(r.bind(r,2119))},2119:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return h}});var a=r(7437),n=r(2265),s=r(6463),d=r(7516),l=r(6410),o=r(6760),i=r(7138),c=r(5419),m=r(9842),x=r(7206),u=r(2976);function h(){return(0,a.jsx)(d.i,{children:(0,a.jsx)(b,{})})}function b(){let{user:e}=(0,l.a)(),t=(0,s.useRouter)(),[r,d]=(0,n.useState)([]),[h,b]=(0,n.useState)([]),[g,p]=(0,n.useState)(new Map),[f,v]=(0,n.useState)(""),[j,N]=(0,n.useState)(!0),[w,y]=(0,n.useState)(!1),k=new x.H;(0,n.useEffect)(()=>{C()},[]);let C=async()=>{try{N(!0);let e=(0,m.IO)((0,m.hJ)(c.db,"food-categories"),(0,m.Xo)("order","asc")),t=(await (0,m.PL)(e)).docs.map(e=>({id:e.id,...e.data()})),r=(0,m.IO)((0,m.hJ)(c.db,"foods")),a=(await (0,m.PL)(r)).docs.map(e=>({id:e.id,...e.data()}));d(t),b(a);let n=new Map;a.forEach(e=>{n.set(e.id,"none")}),p(n)}catch(e){console.error("Error loading food data:",e)}finally{N(!1)}},S=async()=>{if(!e||!f){alert("Please enter a client name before saving.");return}let r=h.filter(e=>{let t=g.get(e.id);return t&&"none"!==t});if(0===r.length){alert("Please select at least one food before saving.");return}y(!0);try{let a=r.map(e=>{let t=g.get(e.id)||"none",r=null;return"approved"===t?r="blue":"neutral"===t?r="yellow":"avoid"===t&&(r="red"),{foodId:e.id,categoryId:e.categoryId||"",colorCode:r,isSelected:!0,notes:"Coach marked as: ".concat(t)}});console.log("Creating document with data:",{clientName:f,ingredients:a,status:"published",userUid:e.uid});let n=await k.createDocument(e.uid,{clientName:f,ingredients:a,status:"published"});if(console.log("Document created successfully:",n),n&&n.id)console.log("Navigating to document view:",n.id),t.push("/dashboard/plans/".concat(n.id));else throw Error("Document was created but has no ID")}catch(t){console.error("Error saving document:",t);let e="Failed to save document. Please try again.";t instanceof Error&&(e="Save failed: ".concat(t.message),console.error("Full error details:",{name:t.name,message:t.message,stack:t.stack})),alert(e)}finally{y(!1)}};if(j)return(0,a.jsx)("div",{className:"min-h-screen bg-brand-cream flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"w-16 h-16 bg-brand-gold rounded-full mx-auto mb-4 flex items-center justify-center animate-pulse",children:(0,a.jsx)("span",{className:"text-brand-white font-prompt font-bold text-2xl",children:"I"})}),(0,a.jsx)("p",{className:"text-brand-dark/60 font-prompt",children:"Loading food database..."})]})});let E=(()=>{let e={approved:0,neutral:0,avoid:0,none:0};return Array.from(g.values()).forEach(t=>{e[t]++}),e})();return(0,a.jsxs)("div",{className:"min-h-screen bg-brand-cream",children:[(0,a.jsx)("header",{className:"bg-brand-dark shadow-lg border-b border-brand-gold/20",children:(0,a.jsx)("div",{className:"max-w-7xl mx-auto px-4 py-6",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("div",{className:"flex items-center space-x-3",children:(0,a.jsx)(i.default,{href:"/dashboard",className:"text-brand-white/70 hover:text-brand-white",children:"← Back to Dashboard"})}),(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)("div",{className:"w-8 h-8 bg-brand-gold rounded-lg flex items-center justify-center",children:(0,a.jsx)("span",{className:"text-brand-white font-prompt font-bold text-lg",children:"I"})}),(0,a.jsx)("h1",{className:"text-brand-white font-prompt font-bold text-2xl",children:"Create Nutrition Plan"})]})]})})}),(0,a.jsx)("div",{className:"bg-brand-white border-b border-brand-gold/20",children:(0,a.jsx)("div",{className:"max-w-7xl mx-auto px-4 py-4",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex-1 max-w-md",children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-brand-dark mb-2 font-prompt",children:"Client Name"}),(0,a.jsx)("input",{type:"text",value:f,onChange:e=>v(e.target.value),className:"w-full px-4 py-3 border border-brand-gold/20 rounded-xl bg-brand-white   focus:outline-none focus:ring-2 focus:ring-brand-gold focus:border-transparent   font-prompt text-brand-dark placeholder-brand-dark/40",placeholder:"Enter client's name"})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-6 text-sm font-prompt",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("div",{className:"w-3 h-3 bg-green-500 rounded-full"}),(0,a.jsxs)("span",{className:"text-brand-dark",children:["Approved: ",E.approved]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("div",{className:"w-3 h-3 bg-yellow-500 rounded-full"}),(0,a.jsxs)("span",{className:"text-brand-dark",children:["Neutral: ",E.neutral]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("div",{className:"w-3 h-3 bg-red-500 rounded-full"}),(0,a.jsxs)("span",{className:"text-brand-dark",children:["Avoid: ",E.avoid]})]})]}),(0,a.jsx)(o.z,{variant:"primary",onClick:S,isLoading:w,disabled:!f||E.approved+E.neutral+E.avoid===0,children:w?"Saving...":"Save Plan"})]})})}),(0,a.jsx)(u.gS,{foods:h.map(e=>({id:e.id,name:e.name,status:g.get(e.id)||"none",categoryId:e.categoryId,nutritionalHighlights:e.nutritionalHighlights})),categories:r.map(e=>({id:e.id,title:e.name,order:e.order})),onStatusChange:(e,t)=>{p(r=>{let a=new Map(r);return a.set(e,t),a})}})]})}},2976:function(e,t,r){"use strict";r.d(t,{gS:function(){return c}});var a=r(7437),n=r(2265);function s(e){let{searchTerm:t,onSearchChange:r,placeholder:n="Search foods..."}=e;return(0,a.jsxs)("div",{className:"relative mb-6",children:[(0,a.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,a.jsx)("svg",{className:"w-5 h-5 text-brand-dark/40",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),(0,a.jsx)("input",{type:"text",value:t,onChange:e=>r(e.target.value),placeholder:n,className:"w-full pl-10 pr-4 py-3 border border-brand-gold/20 rounded-xl bg-brand-white/90 backdrop-blur-sm   focus:outline-none focus:ring-2 focus:ring-brand-gold focus:border-transparent   font-prompt text-brand-dark placeholder-brand-dark/40   transition-all duration-200"})]})}function d(e){let{categories:t,selectedCategory:r,onCategorySelect:n}=e,s=[...t].sort((e,t)=>e.order-t.order);return(0,a.jsx)("div",{className:"mb-6",children:(0,a.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,a.jsx)("button",{onClick:()=>n(void 0),className:"px-4 py-2 rounded-lg font-prompt font-medium transition-all duration-200 text-sm\n            ".concat(r?"bg-brand-white/70 text-brand-dark hover:bg-brand-white border border-brand-gold/20":"bg-brand-gold text-brand-white shadow-md"),children:"All Categories"}),s.map(e=>(0,a.jsx)("button",{onClick:()=>n(e.id),className:"px-4 py-2 rounded-lg font-prompt font-medium transition-all duration-200 text-sm\n              ".concat(r===e.id?"bg-brand-gold text-brand-white shadow-md":"bg-brand-white/70 text-brand-dark hover:bg-brand-white border border-brand-gold/20"),children:e.title},e.id))]})})}let l={approved:{bg:"bg-green-500",border:"border-green-500",text:"text-green-700",label:"Approved"},neutral:{bg:"bg-yellow-500",border:"border-yellow-500",text:"text-yellow-700",label:"Neutral"},avoid:{bg:"bg-red-500",border:"border-red-500",text:"text-red-700",label:"Avoid"},none:{bg:"bg-gray-200",border:"border-gray-300",text:"text-gray-500",label:"Not Set"}};function o(e){let{food:t,onStatusChange:r}=e,n=t.status,s=l[n],d=e=>{r(t.id,e)};return(0,a.jsxs)("div",{className:"bg-brand-white/90 backdrop-blur-sm rounded-xl border border-brand-gold/20 p-4    hover:shadow-md transition-all duration-200 group",children:[(0,a.jsxs)("div",{className:"mb-3",children:[(0,a.jsx)("h3",{className:"font-prompt font-semibold text-brand-dark text-lg leading-tight",children:t.name}),t.nutritionalHighlights&&t.nutritionalHighlights.length>0&&(0,a.jsx)("p",{className:"text-sm text-brand-dark/60 font-prompt mt-1",children:t.nutritionalHighlights.join(", ")})]}),(0,a.jsx)("div",{className:"mb-3",children:(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("div",{className:"w-3 h-3 rounded-full ".concat(s.bg)}),(0,a.jsx)("span",{className:"text-sm font-prompt font-medium ".concat(s.text),children:s.label})]})}),(0,a.jsx)("div",{className:"grid grid-cols-3 gap-1",children:["approved","neutral","avoid"].map(e=>{let t=l[e],r=n===e;return(0,a.jsx)("button",{onClick:()=>d(e),className:"p-2 rounded-lg text-xs font-prompt font-medium transition-all duration-200\n                ".concat(r?"".concat(t.bg," text-white shadow-sm"):"bg-gray-100 ".concat(t.text," hover:bg-gray-200 border ").concat(t.border,"/30")),children:t.label},e)})})]})}function i(e){let{category:t,foods:r,onStatusChange:n}=e;return 0===r.length?null:(0,a.jsxs)("div",{className:"mb-8",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3 mb-4",children:[(0,a.jsx)("div",{className:"w-2 h-8 bg-brand-gold rounded-full"}),(0,a.jsx)("h2",{className:"font-prompt font-bold text-2xl text-brand-dark",children:t.title}),(0,a.jsxs)("span",{className:"bg-brand-gold/20 text-brand-dark font-prompt font-medium text-sm px-3 py-1 rounded-full",children:[r.length," items"]})]}),(0,a.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4",children:r.map(e=>(0,a.jsx)(o,{food:e,onStatusChange:n},e.id))})]})}function c(e){var t;let{foods:r,categories:l,onStatusChange:o}=e,[c,m]=(0,n.useState)(""),[x,u]=(0,n.useState)(),h=(0,n.useMemo)(()=>{let e=r;if(c.trim()){let t=c.toLowerCase();e=e.filter(e=>e.name.toLowerCase().includes(t)||e.nutritionalHighlights&&e.nutritionalHighlights.some(e=>e.toLowerCase().includes(t)))}return x&&(e=e.filter(e=>e.categoryId===x)),e},[r,c,x]),b=(0,n.useMemo)(()=>{let e=new Map;return l.forEach(t=>{e.set(t.id,[])}),h.forEach(t=>{let r=e.get(t.categoryId)||[];r.push(t),e.set(t.categoryId,r)}),e},[h,l]),g=(0,n.useMemo)(()=>[...l].sort((e,t)=>e.order-t.order),[l]);return(0,a.jsxs)("div",{className:"max-w-7xl mx-auto px-4 py-6",children:[(0,a.jsxs)("div",{className:"mb-8",children:[(0,a.jsx)("h1",{className:"font-prompt font-bold text-3xl text-brand-dark mb-2",children:"Food Selection Guide"}),(0,a.jsx)("p",{className:"text-brand-dark/60 font-prompt",children:"Choose foods and set their status for your client's nutrition plan"})]}),(0,a.jsx)(s,{searchTerm:c,onSearchChange:m,placeholder:"Search foods by name or nutritional highlights..."}),(0,a.jsx)(d,{categories:l,selectedCategory:x,onCategorySelect:u}),(0,a.jsx)("div",{className:"mb-6",children:(0,a.jsxs)("div",{className:"flex items-center space-x-4 text-sm text-brand-dark/60 font-prompt",children:[(0,a.jsxs)("span",{children:["Showing ",h.length," foods"]}),c&&(0,a.jsxs)("span",{children:['• Search: "',c,'"']}),x&&(0,a.jsxs)("span",{children:["• Category: ",null===(t=l.find(e=>e.id===x))||void 0===t?void 0:t.title]})]})}),(0,a.jsx)("div",{className:"space-y-8",children:g.map(e=>{let t=b.get(e.id)||[];return(0,a.jsx)(i,{category:e,foods:t,onStatusChange:o},e.id)})}),0===h.length&&(0,a.jsxs)("div",{className:"text-center py-12",children:[(0,a.jsx)("div",{className:"w-16 h-16 bg-brand-gold/20 rounded-full mx-auto mb-4 flex items-center justify-center",children:(0,a.jsx)("svg",{className:"w-8 h-8 text-brand-gold",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),(0,a.jsx)("h3",{className:"font-prompt font-bold text-xl text-brand-dark mb-2",children:"No foods found"}),(0,a.jsx)("p",{className:"text-brand-dark/60 font-prompt mb-4",children:"Try adjusting your search terms or category filter."}),(c||x)&&(0,a.jsx)("button",{onClick:()=>{m(""),u(void 0)},className:"bg-brand-gold text-brand-white px-6 py-2 rounded-lg font-prompt font-medium   hover:bg-brand-gold/90 transition-colors duration-200",children:"Clear Filters"})]})]})}}},function(e){e.O(0,[358,139,990,836,38,732,971,23,744],function(){return e(e.s=2542)}),_N_E=e.O()}]);
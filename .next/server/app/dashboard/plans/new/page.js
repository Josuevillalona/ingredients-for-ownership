(()=>{var e={};e.id=330,e.ids=[330],e.modules={47849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},83122:e=>{"use strict";e.exports=require("undici")},6113:e=>{"use strict";e.exports=require("crypto")},9523:e=>{"use strict";e.exports=require("dns")},82361:e=>{"use strict";e.exports=require("events")},57147:e=>{"use strict";e.exports=require("fs")},13685:e=>{"use strict";e.exports=require("http")},85158:e=>{"use strict";e.exports=require("http2")},41808:e=>{"use strict";e.exports=require("net")},22037:e=>{"use strict";e.exports=require("os")},71017:e=>{"use strict";e.exports=require("path")},77282:e=>{"use strict";e.exports=require("process")},12781:e=>{"use strict";e.exports=require("stream")},24404:e=>{"use strict";e.exports=require("tls")},57310:e=>{"use strict";e.exports=require("url")},73837:e=>{"use strict";e.exports=require("util")},59796:e=>{"use strict";e.exports=require("zlib")},41446:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>i.a,__next_app__:()=>m,originalPathname:()=>u,pages:()=>c,routeModule:()=>h,tree:()=>d}),s(76840),s(22834),s(32325),s(35866);var r=s(23191),a=s(88716),l=s(37922),i=s.n(l),n=s(95231),o={};for(let e in n)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>n[e]);s.d(t,o);let d=["",{children:["dashboard",{children:["plans",{children:["new",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,76840)),"C:\\Users\\josue\\Documents\\Builds\\ingredients-for-ownership\\src\\app\\dashboard\\plans\\new\\page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,22834)),"C:\\Users\\josue\\Documents\\Builds\\ingredients-for-ownership\\src\\app\\dashboard\\layout.tsx"]}]},{layout:[()=>Promise.resolve().then(s.bind(s,32325)),"C:\\Users\\josue\\Documents\\Builds\\ingredients-for-ownership\\src\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,35866,23)),"next/dist/client/components/not-found-error"]}],c=["C:\\Users\\josue\\Documents\\Builds\\ingredients-for-ownership\\src\\app\\dashboard\\plans\\new\\page.tsx"],u="/dashboard/plans/new/page",m={require:s,loadChunk:()=>Promise.resolve()},h=new r.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/dashboard/plans/new/page",pathname:"/dashboard/plans/new",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},74018:(e,t,s)=>{Promise.resolve().then(s.bind(s,62486))},35047:(e,t,s)=>{"use strict";var r=s(77389);s.o(r,"useParams")&&s.d(t,{useParams:function(){return r.useParams}}),s.o(r,"useRouter")&&s.d(t,{useRouter:function(){return r.useRouter}}),s.o(r,"useSearchParams")&&s.d(t,{useSearchParams:function(){return r.useSearchParams}})},62486:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>h});var r=s(10326),a=s(17577),l=s(99837),i=s(81985),n=s(88549),o=s(92862),d=s(87854);function c({selectedClientId:e,onPlanCreated:t}){let{foods:s,loading:c,loadFoods:u}=(0,o.x)(),{clients:m,isLoading:h}=(0,d.a)(),[x,g]=(0,a.useState)(null),[p,b]=(0,a.useState)(""),[f,w]=(0,a.useState)({}),[y,j]=(0,a.useState)(""),[v,N]=(0,a.useState)("all"),[C,P]=(0,a.useState)(!1),q=s.filter(e=>{let t=e.name.toLowerCase().includes(y.toLowerCase())||e.tags.some(e=>e.toLowerCase().includes(y.toLowerCase())),s="all"===v||e.category===v;return t&&s}),S={blue:q.filter(e=>"blue"===e.category),yellow:q.filter(e=>"yellow"===e.category),red:q.filter(e=>"red"===e.category)},k=e=>{let t=e.id;if(f[t]){let e={...f};delete e[t],w(e)}else{let s={foodId:e.id,foodName:e.name,category:e.category,servingSize:e.servingSize,mealType:"breakfast",notes:""};w(e=>({...e,[t]:s}))}},E=async e=>{await u(),setTimeout(()=>{let t=s.find(t=>t.id===e);t&&k(t)},100),P(!1)},F=async()=>{if(!x){alert("Please select a client");return}if(0===Object.keys(f).length){alert("Please select at least one food item");return}console.log("Creating plan:",{clientId:x.id,title:p,foods:Object.values(f)}),t&&t("new-plan-id")},U=Object.keys(f).length;return c||h?r.jsx("div",{className:"flex items-center justify-center py-12",children:(0,r.jsxs)("div",{className:"text-center",children:[r.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-brand-gold mx-auto mb-4"}),r.jsx("p",{className:"text-gray-600",children:"Loading..."})]})}):C?r.jsx("div",{className:"space-y-6",children:(0,r.jsxs)("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[r.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Add Food to Plan"}),r.jsx(l.z,{variant:"outline",onClick:()=>P(!1),children:"Back to Plan"})]}),r.jsx(n.f,{onSuccess:E,onCancel:()=>P(!1),onManualAdd:()=>{console.log("Manual add requested during plan creation")}})]})}):(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[r.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Create Nutrition Plan"}),!e&&(0,r.jsxs)("div",{className:"mb-4",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Select Client"}),(0,r.jsxs)("select",{value:x?.id||"",onChange:e=>{let t=m.find(t=>t.id===e.target.value);g(t||null),t&&b(`Nutrition Plan for ${t.name}`)},className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-brand-gold focus:border-brand-gold",children:[r.jsx("option",{value:"",children:"Choose a client..."}),m.map(e=>r.jsx("option",{value:e.id,children:e.name},e.id))]})]}),(0,r.jsxs)("div",{className:"mb-4",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Plan Title"}),r.jsx("input",{type:"text",value:p,onChange:e=>b(e.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-brand-gold focus:border-brand-gold",placeholder:"Enter plan title..."})]}),(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"text-sm text-gray-600",children:[U," food",1!==U?"s":""," selected"]}),(0,r.jsxs)(l.z,{onClick:F,disabled:!x||!p.trim()||0===U,children:["Create Plan (",U,")"]})]})]}),(0,r.jsxs)("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[(0,r.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4 mb-6",children:[r.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Select Foods for Plan"}),(0,r.jsxs)("div",{className:"flex gap-3 items-center",children:[r.jsx("div",{className:"flex-1 max-w-md",children:r.jsx("input",{type:"text",value:y,onChange:e=>j(e.target.value),placeholder:"Search foods...",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-brand-gold focus:border-brand-gold"})}),r.jsx(l.z,{variant:"outline",onClick:()=>P(!0),className:"whitespace-nowrap",children:"+ Add New Food"})]})]}),(0,r.jsxs)("div",{className:"flex gap-2 mb-6 overflow-x-auto",children:[(0,r.jsxs)("button",{onClick:()=>N("all"),className:`px-4 py-2 text-sm font-medium rounded-lg whitespace-nowrap transition-colors ${"all"===v?"bg-brand-gold text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:["All Foods (",q.length,")"]}),(0,r.jsxs)("button",{onClick:()=>N("blue"),className:`px-4 py-2 text-sm font-medium rounded-lg whitespace-nowrap transition-colors ${"blue"===v?"bg-blue-600 text-white":"bg-blue-100 text-blue-700 hover:bg-blue-200"}`,children:["Blue Foods (",S.blue.length,")"]}),(0,r.jsxs)("button",{onClick:()=>N("yellow"),className:`px-4 py-2 text-sm font-medium rounded-lg whitespace-nowrap transition-colors ${"yellow"===v?"bg-yellow-600 text-white":"bg-yellow-100 text-yellow-700 hover:bg-yellow-200"}`,children:["Yellow Foods (",S.yellow.length,")"]}),(0,r.jsxs)("button",{onClick:()=>N("red"),className:`px-4 py-2 text-sm font-medium rounded-lg whitespace-nowrap transition-colors ${"red"===v?"bg-red-600 text-white":"bg-red-100 text-red-700 hover:bg-red-200"}`,children:["Red Foods (",S.red.length,")"]})]}),r.jsx("div",{className:"space-y-6",children:Object.entries(S).map(([e,t])=>"all"!==v&&v!==e||0===t.length?null:(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"flex items-center gap-3 mb-4",children:[(0,r.jsxs)(i.r,{category:e,children:[e.charAt(0).toUpperCase()+e.slice(1)," Foods"]}),(0,r.jsxs)("span",{className:"text-sm text-gray-500",children:["(",t.length," foods)"]})]}),r.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3",children:t.map(e=>{let t=!!f[e.id];return(0,r.jsxs)("div",{onClick:()=>k(e),className:`
                          p-4 border-2 rounded-lg cursor-pointer transition-all
                          ${t?"border-brand-gold bg-brand-cream shadow-md":"border-gray-200 hover:border-gray-300 hover:shadow-sm"}
                        `,children:[(0,r.jsxs)("div",{className:"flex items-start justify-between mb-2",children:[r.jsx("h4",{className:"font-medium text-gray-900 text-sm leading-tight",children:e.name}),r.jsx("div",{className:"ml-2 flex-shrink-0",children:r.jsx("div",{className:`
                              w-5 h-5 rounded border-2 flex items-center justify-center
                              ${t?"bg-brand-gold border-brand-gold":"border-gray-300"}
                            `,children:t&&r.jsx("svg",{className:"w-3 h-3 text-white",fill:"currentColor",viewBox:"0 0 20 20",children:r.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})})})]}),e.servingSize&&(0,r.jsxs)("p",{className:"text-xs text-gray-600 mb-1",children:[r.jsx("span",{className:"font-medium",children:"Serving:"})," ",e.servingSize]}),e.description&&r.jsx("p",{className:"text-xs text-gray-500 line-clamp-2",children:e.description})]},e.id)})})]},e))}),0===q.length&&(0,r.jsxs)("div",{className:"text-center py-12",children:[r.jsx("p",{className:"text-gray-500 mb-4",children:y?`No foods found matching "${y}"`:"No foods available"}),(0,r.jsxs)("div",{className:"flex flex-col sm:flex-row gap-3 justify-center",children:[y&&r.jsx(l.z,{variant:"secondary",onClick:()=>j(""),children:"Clear Search"}),r.jsx(l.z,{onClick:()=>P(!0),className:"bg-brand-gold hover:bg-brand-gold/90",children:"+ Add New Food"})]})]})]}),U>0&&(0,r.jsxs)("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[(0,r.jsxs)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:["Selected Foods (",U,")"]}),r.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3",children:Object.values(f).map(e=>(0,r.jsxs)("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[r.jsx(i.r,{category:e.category,size:"sm",children:e.category.charAt(0).toUpperCase()}),r.jsx("span",{className:"text-sm font-medium",children:e.foodName})]}),r.jsx("button",{onClick:()=>{let t={...f};delete t[e.foodId],w(t)},className:"text-red-600 hover:text-red-800 text-sm",children:"Remove"})]},e.foodId))})]})]})}var u=s(35047);function m(){let e=(0,u.useSearchParams)().get("clientId");return(0,r.jsxs)("div",{className:"min-h-screen bg-brand-cream",children:[r.jsx("header",{className:"bg-brand-dark shadow-lg border-b border-brand-gold/20",children:r.jsx("div",{className:"max-w-7xl mx-auto px-4 py-6",children:(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[r.jsx("div",{className:"w-8 h-8 bg-brand-gold rounded-lg flex items-center justify-center",children:r.jsx("span",{className:"text-brand-white font-prompt font-bold text-lg",children:"\uD83D\uDCCB"})}),(0,r.jsxs)("div",{children:[r.jsx("h1",{className:"text-brand-white font-prompt font-bold text-2xl",children:"Create Nutrition Plan"}),r.jsx("p",{className:"text-brand-white/80 text-sm",children:"Build a comprehensive one-pager nutrition guide"})]})]})})}),r.jsx("main",{className:"max-w-7xl mx-auto px-4 py-8",children:r.jsx(c,{selectedClientId:e||void 0,onPlanCreated:e=>{console.log("Plan created:",e),alert("Plan created successfully!")}})})]})}function h(){return r.jsx(a.Suspense,{fallback:r.jsx("div",{className:"min-h-screen bg-brand-cream flex items-center justify-center",children:r.jsx("div",{className:"animate-spin w-8 h-8 border-2 border-brand-gold border-t-transparent rounded-full"})}),children:r.jsx(m,{})})}},37464:(e,t,s)=>{"use strict";s.d(t,{T:()=>i});var r=s(76),a=s(76025);class l{async createClient(e,t){try{let s=(0,r.JU)((0,r.hJ)(a.db,this.collectionName)),l=s.id,i={coachId:e,name:t.name.trim(),sessionNotes:t.sessionNotes?.trim()||"",goals:t.goals.filter(e=>e.trim().length>0),restrictions:t.restrictions.filter(e=>e.trim().length>0),createdAt:r.EK.now(),lastUpdated:r.EK.now()};return t.email?.trim()&&(i.email=t.email.trim()),await (0,r.pl)(s,i),l}catch(e){throw Error(`Failed to create client: ${e.message}`)}}async getClientsForCoach(e){try{let t=(0,r.IO)((0,r.hJ)(a.db,this.collectionName),(0,r.ar)("coachId","==",e),(0,r.Xo)("lastUpdated","desc"));return(await (0,r.PL)(t)).docs.map(e=>({id:e.id,...e.data()}))}catch(e){throw Error(`Failed to fetch clients: ${e.message}`)}}async getClient(e,t){try{let s=await (0,r.QT)((0,r.JU)(a.db,this.collectionName,e));if(!s.exists())return null;let l=s.data();if(l.coachId!==t)throw Error("Access denied: Client belongs to different coach");return{id:s.id,...l}}catch(e){throw Error(`Failed to fetch client: ${e.message}`)}}async updateClient(e,t,s){try{if(!await this.getClient(e,t))throw Error("Client not found or access denied");let l={lastUpdated:r.EK.now()};s.name?.trim()&&(l.name=s.name.trim()),void 0!==s.email&&(l.email=s.email?.trim()||void 0),void 0!==s.sessionNotes&&(l.sessionNotes=s.sessionNotes?.trim()||""),s.goals&&(l.goals=s.goals.filter(e=>e.trim().length>0)),s.restrictions&&(l.restrictions=s.restrictions.filter(e=>e.trim().length>0)),await (0,r.r7)((0,r.JU)(a.db,this.collectionName,e),l)}catch(e){throw Error(`Failed to update client: ${e.message}`)}}async deleteClient(e,t){try{if(!await this.getClient(e,t))throw Error("Client not found or access denied");await (0,r.oe)((0,r.JU)(a.db,this.collectionName,e))}catch(e){throw Error(`Failed to delete client: ${e.message}`)}}async searchClients(e,t){try{let s=await this.getClientsForCoach(e);if(!t.trim())return s;let r=t.toLowerCase();return s.filter(e=>e.name.toLowerCase().includes(r)||e.email?.toLowerCase().includes(r)||e.goals.some(e=>e.toLowerCase().includes(r)))}catch(e){throw Error(`Failed to search clients: ${e.message}`)}}constructor(){this.collectionName="clients"}}let i=new l},87854:(e,t,s)=>{"use strict";s.d(t,{a:()=>i});var r=s(17577),a=s(54733),l=s(37464);function i(){let{user:e}=(0,a.a)(),[t,s]=(0,r.useState)([]),[i,n]=(0,r.useState)(!1),[o,d]=(0,r.useState)(null),c=async()=>{if(e){n(!0),d(null);try{let t=await l.T.getClientsForCoach(e.uid);s(t)}catch(e){d(e.message)}finally{n(!1)}}};return{clients:t,isLoading:i,error:o,createClient:async t=>{if(!e)throw Error("User not authenticated");try{let s=await l.T.createClient(e.uid,t);return await c(),s}catch(e){throw d(e.message),e}},updateClient:async(t,s)=>{if(!e)throw Error("User not authenticated");try{await l.T.updateClient(t,e.uid,s),await c()}catch(e){throw d(e.message),e}},deleteClient:async t=>{if(!e)throw Error("User not authenticated");try{await l.T.deleteClient(t,e.uid),await c()}catch(e){throw d(e.message),e}},searchClients:async t=>{if(!e)return[];try{return await l.T.searchClients(e.uid,t)}catch(e){return d(e.message),[]}},refetch:c}}},76840:(e,t,s)=>{"use strict";s.r(t),s.d(t,{$$typeof:()=>i,__esModule:()=>l,default:()=>n});var r=s(68570);let a=(0,r.createProxy)(String.raw`C:\Users\josue\Documents\Builds\ingredients-for-ownership\src\app\dashboard\plans\new\page.tsx`),{__esModule:l,$$typeof:i}=a;a.default;let n=(0,r.createProxy)(String.raw`C:\Users\josue\Documents\Builds\ingredients-for-ownership\src\app\dashboard\plans\new\page.tsx#default`)}};var t=require("../../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),r=t.X(0,[948,53,862,133],()=>s(41446));module.exports=r})();